/* ===========================
   src/components/HintLegend.css
   =========================== */

/* HintLegend Component */
.hint-legend {
  padding: var(--space-3);
  margin-bottom: var(--space-2);
}

.hint-legend-header {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  margin-bottom: var(--space-3);
}

.hint-legend-title {
  /* Inherit .card-title typography; keep only spacing */
  margin-bottom: 0; /* header handles spacing */
}

/* The list itself is a simple block; each item handles its own grid */
.hint-legend-list {
  margin: 0;
  padding: 0; /* remove left indent to align with Common Patterns list */
  list-style: none;
}

.hint-legend-list li {
  margin-bottom: var(--space-1);
}
.hint-legend-list li:last-child {
  margin-bottom: 0;
}

.hint-legend-item {
  display: grid;
  grid-template-columns: 93px 1fr;
  column-gap: var(--space-3);
  align-items: start;
  margin-bottom: var(--space-2);
}

/* Slightly soften the fixed label width on cramped viewports */
@media (max-width: 420px) {
  .hint-legend-item {
    grid-template-columns: 84px 1fr;
  }
}

.hint-legend-item:last-child {
  margin-bottom: 0;
}

.hint-legend-description {
  font-size: var(--text-sm);
  line-height: 1.4;
  color: var(--muted-strong);
  max-width: 100%;
  font-variant-numeric: tabular-nums;
}

/* Mobile optimizations for component-specific styles */
@media (max-width: var(--breakpoint-mobile)) {  
  .hint-legend-item {
    grid-template-columns: 1fr;
    gap: var(--space-2);
  }
}

/* Static common-patterns toggle (enhanced as a bordered pill with states) */
.legend-toggle {
  --toggle-border: color-mix(in srgb, var(--muted-strong) 32%, transparent);
  --toggle-bg: color-mix(in srgb, currentColor 6%, transparent);
  --toggle-bg-hover: color-mix(in srgb, currentColor 10%, transparent);

  display: inline-flex;
  align-items: center;
  gap: var(--space-2);
  padding: var(--space-1) var(--space-2);
  background: var(--toggle-bg);
  border: 1px solid var(--toggle-border);
  border-radius: 10px;
  cursor: pointer;
  font: inherit;
  color: inherit;
  transition: background-color 120ms ease, border-color 120ms ease, transform 120ms ease;
  /* Override global button min-height so these can be slim (globals sets a high min) */
  min-height: 0;
  line-height: 1.1;
}

.legend-toggle:hover {
  background: var(--toggle-bg-hover);
}

.legend-toggle:focus-visible {
  outline: none;
  box-shadow:
    0 0 0 2px color-mix(in srgb, var(--bubble-amber) 30%, transparent),
    0 0 0 4px color-mix(in srgb, var(--bubble-amber) 18%, transparent);
}

/* Smaller visual weight for the sub-level toggle */
.legend-toggle--sub {
  padding-block: var(--space-1);
}

.legend-toggle-label {
  font-weight: 600;
}

.legend-toggle-label--sub {
  font-weight: 400;
  font-size: var(--text-sm);
  letter-spacing: .01em;
  /* color set by [data-mode] below */
}

/* Caret: size + rotation when expanded */
.legend-toggle-caret {
  display: inline-block;
  margin-left: .25rem;
  transform: rotate(0deg);
  transition: transform 160ms ease;
  line-height: 1;
}

.legend-toggle[aria-expanded="true"] .legend-toggle-caret {
  transform: rotate(180deg);
}

.hint-legend-common .legend-toggle--sub {
  margin-top: var(--space-4);
}

/* Common Patterns list should align exactly with the top list */
.hint-legend-list--indent {
  margin: 0;            /* align with the main list */
  padding: 0;
  list-style: none;
  margin-top: var(--space-2); /* just a bit of vertical separation */
}

/* Slight vertical rhythm guard when legend appears after other cards */
.hint-legend + .card {
  margin-top: var(--space-2);
}

/* -------------------------------
   Tone-matched box for the header
   ------------------------------- */
/* Defaults for Patterns — lean amber like your pattern tags */
.hint-legend-common {
  --legend-tone: var(--bubble-amber);
}
.hint-legend-common[data-mode="patterns"] .legend-toggle--sub,
.hint-legend-common[data-mode="patterns"] .legend-toggle-label--sub {
  color: var(--legend-tone);
}
.hint-legend-common[data-mode="patterns"] .legend-toggle--sub {
  border-color: color-mix(in oklab, var(--legend-tone) 55%, transparent);
  background: color-mix(in oklab, var(--legend-tone) 12%, transparent);
}

/* Play Types — style like go-toggle (use the base .legend-toggle skin) */
.hint-legend-common[data-mode="playtypes"] .legend-toggle-label--sub {
  color: inherit; /* same as go-toggle title color */
}

/* ---------------------------------------------
   Slimmer “mini” toggles for grouped play types
   --------------------------------------------- */
/* Render the grouped parent as a CHIP-LIKE dropdown button (neutral chip look) */
.chip-button {
  display: inline-flex; align-items: center; gap: var(--space-2);
  border: 1px solid var(--card-bd);                 /* chip--neutral border */
  border-radius: 9999px;
  padding: calc(var(--space-1) * 0.5) var(--space-2);
  font-size: var(--text-xs);
  min-height: 24px; /* matches .chip; stays slim even with global touch target */
  line-height: 1.15;
  color: var(--fg);                                     /* chip--neutral text */
  background: color-mix(in oklab, var(--card) 60%, transparent); /* chip--neutral bg */
  cursor: pointer;
  margin: var(--space-1);          /* match .chip spacing so they align inline */
  vertical-align: middle;          /* align with neighboring chips */
}
.chip-button .legend-toggle-caret { margin-left: .25rem; }
.legend-toggle--mini:not(.chip-button) { padding: 0; border: none; background: transparent; } /* keep chip border */
.chip-button__label { display: inline-block; }

/* Make a chip fill its grid column (used by Box toggle) */
.chip-button--full { width: 100%; justify-content: space-between; }

/* Chip-button interactions to mirror tag behavior */
.chip-button:hover {
  background: color-mix(in oklab, var(--card) 70%, transparent);
}
.chip-button:focus-visible {
  outline: none;
  box-shadow:
    0 0 0 2px color-mix(in srgb, var(--bubble-amber) 30%, transparent),
    0 0 0 4px color-mix(in srgb, var(--bubble-amber) 18%, transparent);
}

/* -----------------------------------------
   Sub-tags open beneath (not to the right)
   ----------------------------------------- */
.hint-legend-item--group-vertical {
  /* Collapse to a single column so the nested list flows BELOW the toggle */
  grid-template-columns: 1fr;
}
.hint-legend-item--group-vertical .legend-toggle {
  width: fit-content;
}
.hint-legend-item--group-vertical > .hint-legend-list {
  /* Ensure the nested list takes the full width under the parent */
  grid-column: 1 / -1;
}
.hint-legend-list--tiny {
  margin-top: var(--space-2);
  margin-left: var(--space-4);   /* comfortable indent under the parent */
  padding-left: 0;
  list-style: none;
}

/* Inline group: keep the two-column grid so description sits to the right */
.hint-legend-item--group-inline {
  /* Inherit the default two-column grid from .hint-legend-item (93px 1fr) */
}
.hint-legend-item--group-inline > .hint-legend-list {
  /* When open, sub-items span across both columns below the button+description row */
  grid-column: 1 / -1;
}

/* Utility: force a nested list to span both columns in any layout */
.hint-legend-list--span {
  grid-column: 1 / -1;
}

/* Small screens: inline group collapses nicely like standard items */
@media (max-width: var(--breakpoint-mobile)) {
  .hint-legend-item--group-inline .chip-button--full {
    width: 100%;
  }
}
